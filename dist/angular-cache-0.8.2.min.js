!function(a,b){"use strict";function c(){this.$get=["$timeout","$q",function(a){function c(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=c);return b}function d(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}function e(e,f){function h(b,c){r[b].timeoutId=a(function(){v.remove(b)},c)}function i(a,c){b.isNumber(a)?0>a?c("must be greater than zero!",a):c(null,a):c("must be a number!",a)}function j(a,b){a===Number.MAX_VALUE?(q.capacity=a,b(null,q.capacity)):i(a,function(a,c){if(a)b(a,c);else{for(q.capacity=c;p>q.capacity;)v.remove(u.key);b(null,q.capacity)}})}function k(b,c){var e=d(r);if(null===b){q.maxAge=b;for(var f=0;f<e.length;f++){var g=e[f];r[g].timeoutId&&!r[g].maxAge&&a.cancel(r[g].timeoutId)}c(null,q.maxAge)}else i(b,function(b,d){if(b)c(b,d);else{q.maxAge=d;for(var f=0;f<e.length;f++){var g=e[f];if(r[g].timeoutId&&!r[g].maxAge){a.cancel(r[g].timeoutId);var i=(new Date).getTime()-r[g].timestamp;q.maxAge-i>0?h(g,q.maxAge):v.remove(g)}}c(null,q.maxAge)}})}function l(b,c){q.cacheFlushIntervalId&&(clearInterval(q.cacheFlushIntervalId),delete q.cacheFlushIntervalId),null===b?(q.cacheFlushInterval=b,c(null,q.cacheFlushInterval)):i(b,function(b,e){b?c(b,e):(q.cacheFlushInterval=e,q.cacheFlushIntervalId=setInterval(function(){for(var b=d(r),c=0;c<b.length;c++){var e=b[c];r[e].timeoutId&&a.cancel(r[e].timeoutId)}p=0,r={},s={},t=null,u=null},q.cacheFlushInterval),c(null,q.cacheFlushInterval))})}function m(a,b){b=b||!1,(a.capacity||b)&&j(a.capacity?a.capacity:Number.MAX_VALUE,function(a){if(a)throw new Error("capacity: "+a)}),(a.maxAge||b)&&k(a.maxAge?a.maxAge:null,function(a){if(a)throw new Error("maxAge: "+a)}),(a.cacheFlushInterval||b)&&l(a.cacheFlushInterval?a.cacheFlushInterval:null,function(a){if(a)throw new Error("cacheFlushInterval: "+a)})}function n(a){a!==t&&(u?u===a&&(u=a.n):u=a,o(a.n,a.p),o(a,t),t=a,t.n=null)}function o(a,b){a!==b&&(a&&(a.p=b),b&&(b.n=a))}var p=0,q=b.extend({},{id:e}),r={},s={},t=null,u=null,v=this;f=f||{},m(f,!0),this.put=function(c,d,e){var f=s[c]||(s[c]={key:c});if(!b.isString(c))throw new Error("The key must be a string!");return e&&e.maxAge&&i(e.maxAge,function(a){if(a)throw new Error("AngularCache.put(): maxAge: "+a)}),n(f),b.isUndefined(d)?void 0:(c in r||p++,r[c]={value:d},(e&&e.maxAge||q.maxAge)&&(r[c].timestamp=(new Date).getTime(),r[c].timeoutId&&a.cancel(r[c].timeoutId),h(c,e&&e.maxAge||q.maxAge)),p>q.capacity&&this.remove(u.key),d)},this.get=function(a){var b=s[a];if(b)return n(b),r[a].value},this.remove=function(a){var b=s[a];b&&(b===t&&(t=b.p),b===u&&(u=b.n),o(b.n,b.p),delete s[a],delete r[a],p--)},this.removeAll=function(){r={},p=0,s={},t=null,u=null},this.destroy=function(){clearInterval(q.cacheFlushIntervalId),r=null,q=null,s=null,delete g[e]},this.info=function(){return b.extend({},q,{size:p})},this.keySet=function(){return c(r)},this.keys=function(){return d(r)},this.setOptions=m}function f(a,c){if(a in g)throw new Error("cacheId "+a+" taken!");if(!b.isString(a))throw new Error("cacheId must be a string!");return g[a]=new e(a,c),g[a]}var g={};return f.info=function(){for(var a={},b=d(g),c=0;c<b.length;c++){var e=b[c];a[e]=g[e].info()}return a},f.get=function(a){return g[a]},f.keySet=function(){return c(g)},f.keys=function(){return d(g)},f}]}b.module("angular-cache",["ng"]),b.module("angular-cache").provider("$angularCacheFactory",c)}(window,window.angular);